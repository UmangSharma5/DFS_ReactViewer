{"ast":null,"code":"import _regeneratorRuntime from \"/home/umang/iHub/DFS_ReactViewer/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/umang/iHub/DFS_ReactViewer/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/home/umang/iHub/DFS_ReactViewer/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/umang/iHub/DFS_ReactViewer/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/home/umang/iHub/DFS_ReactViewer/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/umang/iHub/DFS_ReactViewer/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport fs from 'fs';\nimport { BaseSource } from './basesource.js';\nfunction closeAsync(fd) {\n  return new Promise(function (resolve, reject) {\n    fs.close(fd, function (err) {\n      if (err) {\n        reject(err);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\nfunction openAsync(path, flags) {\n  var mode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n  return new Promise(function (resolve, reject) {\n    fs.open(path, flags, mode, function (err, fd) {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(fd);\n      }\n    });\n  });\n}\nfunction readAsync() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  return new Promise(function (resolve, reject) {\n    fs.read.apply(fs, args.concat([function (err, bytesRead, buffer) {\n      if (err) {\n        reject(err);\n      } else {\n        resolve({\n          bytesRead: bytesRead,\n          buffer: buffer\n        });\n      }\n    }]));\n  });\n}\nvar FileSource = /*#__PURE__*/function (_BaseSource) {\n  _inherits(FileSource, _BaseSource);\n  var _super = _createSuper(FileSource);\n  function FileSource(path) {\n    var _this;\n    _classCallCheck(this, FileSource);\n    _this = _super.call(this);\n    _this.path = path;\n    _this.openRequest = openAsync(path, 'r');\n    return _this;\n  }\n  _createClass(FileSource, [{\n    key: \"fetchSlice\",\n    value: function () {\n      var _fetchSlice = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(slice) {\n        var fd, _yield$readAsync, buffer;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return this.openRequest;\n            case 2:\n              fd = _context.sent;\n              _context.next = 5;\n              return readAsync(fd, Buffer.alloc(slice.length), 0, slice.length, slice.offset);\n            case 5:\n              _yield$readAsync = _context.sent;\n              buffer = _yield$readAsync.buffer;\n              return _context.abrupt(\"return\", buffer.buffer);\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function fetchSlice(_x) {\n        return _fetchSlice.apply(this, arguments);\n      }\n      return fetchSlice;\n    }()\n  }, {\n    key: \"close\",\n    value: function () {\n      var _close = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var fd;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this.openRequest;\n            case 2:\n              fd = _context2.sent;\n              _context2.next = 5;\n              return closeAsync(fd);\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function close() {\n        return _close.apply(this, arguments);\n      }\n      return close;\n    }()\n  }]);\n  return FileSource;\n}(BaseSource);\nexport function makeFileSource(path) {\n  return new FileSource(path);\n}","map":{"version":3,"names":["fs","BaseSource","closeAsync","fd","Promise","resolve","reject","close","err","openAsync","path","flags","mode","arguments","length","undefined","open","readAsync","_len","args","Array","_key","read","apply","concat","bytesRead","buffer","FileSource","_BaseSource","_inherits","_super","_createSuper","_this","_classCallCheck","call","openRequest","_createClass","key","value","_fetchSlice","_asyncToGenerator","_regeneratorRuntime","mark","_callee","slice","_yield$readAsync","wrap","_callee$","_context","prev","next","sent","Buffer","alloc","offset","abrupt","stop","fetchSlice","_x","_close","_callee2","_callee2$","_context2","makeFileSource"],"sources":["/home/umang/iHub/DFS_ReactViewer/client/node_modules/geotiff/dist-module/source/file.js"],"sourcesContent":["import fs from 'fs';\nimport { BaseSource } from './basesource.js';\n\nfunction closeAsync(fd) {\n  return new Promise((resolve, reject) => {\n    fs.close(fd, (err) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\n\nfunction openAsync(path, flags, mode = undefined) {\n  return new Promise((resolve, reject) => {\n    fs.open(path, flags, mode, (err, fd) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(fd);\n      }\n    });\n  });\n}\n\nfunction readAsync(...args) {\n  return new Promise((resolve, reject) => {\n    fs.read(...args, (err, bytesRead, buffer) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve({ bytesRead, buffer });\n      }\n    });\n  });\n}\n\nclass FileSource extends BaseSource {\n  constructor(path) {\n    super();\n    this.path = path;\n    this.openRequest = openAsync(path, 'r');\n  }\n\n  async fetchSlice(slice) {\n    // TODO: use `signal`\n    const fd = await this.openRequest;\n    const { buffer } = await readAsync(\n      fd,\n      Buffer.alloc(slice.length),\n      0,\n      slice.length,\n      slice.offset,\n    );\n    return buffer.buffer;\n  }\n\n  async close() {\n    const fd = await this.openRequest;\n    await closeAsync(fd);\n  }\n}\n\nexport function makeFileSource(path) {\n  return new FileSource(path);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}