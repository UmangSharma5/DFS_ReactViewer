{"ast":null,"code":"import fs from 'fs';\nimport { BaseSource } from './basesource.js';\nfunction closeAsync(fd) {\n  return new Promise((resolve, reject) => {\n    fs.close(fd, err => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\nfunction openAsync(path, flags) {\n  let mode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n  return new Promise((resolve, reject) => {\n    fs.open(path, flags, mode, (err, fd) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(fd);\n      }\n    });\n  });\n}\nfunction readAsync() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  return new Promise((resolve, reject) => {\n    fs.read(...args, (err, bytesRead, buffer) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve({\n          bytesRead,\n          buffer\n        });\n      }\n    });\n  });\n}\nclass FileSource extends BaseSource {\n  constructor(path) {\n    super();\n    this.path = path;\n    this.openRequest = openAsync(path, 'r');\n  }\n  async fetchSlice(slice) {\n    // TODO: use `signal`\n    const fd = await this.openRequest;\n    const {\n      buffer\n    } = await readAsync(fd, Buffer.alloc(slice.length), 0, slice.length, slice.offset);\n    return buffer.buffer;\n  }\n  async close() {\n    const fd = await this.openRequest;\n    await closeAsync(fd);\n  }\n}\nexport function makeFileSource(path) {\n  return new FileSource(path);\n}","map":{"version":3,"names":["fs","BaseSource","closeAsync","fd","Promise","resolve","reject","close","err","openAsync","path","flags","mode","arguments","length","undefined","open","readAsync","_len","args","Array","_key","read","bytesRead","buffer","FileSource","constructor","openRequest","fetchSlice","slice","Buffer","alloc","offset","makeFileSource"],"sources":["/home/umang/iHub/DFS_ReactViewer/client/node_modules/geotiff/dist-module/source/file.js"],"sourcesContent":["import fs from 'fs';\nimport { BaseSource } from './basesource.js';\n\nfunction closeAsync(fd) {\n  return new Promise((resolve, reject) => {\n    fs.close(fd, (err) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\n\nfunction openAsync(path, flags, mode = undefined) {\n  return new Promise((resolve, reject) => {\n    fs.open(path, flags, mode, (err, fd) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(fd);\n      }\n    });\n  });\n}\n\nfunction readAsync(...args) {\n  return new Promise((resolve, reject) => {\n    fs.read(...args, (err, bytesRead, buffer) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve({ bytesRead, buffer });\n      }\n    });\n  });\n}\n\nclass FileSource extends BaseSource {\n  constructor(path) {\n    super();\n    this.path = path;\n    this.openRequest = openAsync(path, 'r');\n  }\n\n  async fetchSlice(slice) {\n    // TODO: use `signal`\n    const fd = await this.openRequest;\n    const { buffer } = await readAsync(\n      fd,\n      Buffer.alloc(slice.length),\n      0,\n      slice.length,\n      slice.offset,\n    );\n    return buffer.buffer;\n  }\n\n  async close() {\n    const fd = await this.openRequest;\n    await closeAsync(fd);\n  }\n}\n\nexport function makeFileSource(path) {\n  return new FileSource(path);\n}\n"],"mappings":"AAAA,OAAOA,EAAE,MAAM,IAAI;AACnB,SAASC,UAAU,QAAQ,iBAAiB;AAE5C,SAASC,UAAUA,CAACC,EAAE,EAAE;EACtB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCN,EAAE,CAACO,KAAK,CAACJ,EAAE,EAAGK,GAAG,IAAK;MACpB,IAAIA,GAAG,EAAE;QACPF,MAAM,CAACE,GAAG,CAAC;MACb,CAAC,MAAM;QACLH,OAAO,CAAC,CAAC;MACX;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;AAEA,SAASI,SAASA,CAACC,IAAI,EAAEC,KAAK,EAAoB;EAAA,IAAlBC,IAAI,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGE,SAAS;EAC9C,OAAO,IAAIX,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCN,EAAE,CAACgB,IAAI,CAACN,IAAI,EAAEC,KAAK,EAAEC,IAAI,EAAE,CAACJ,GAAG,EAAEL,EAAE,KAAK;MACtC,IAAIK,GAAG,EAAE;QACPF,MAAM,CAACE,GAAG,CAAC;MACb,CAAC,MAAM;QACLH,OAAO,CAACF,EAAE,CAAC;MACb;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;AAEA,SAASc,SAASA,CAAA,EAAU;EAAA,SAAAC,IAAA,GAAAL,SAAA,CAAAC,MAAA,EAANK,IAAI,OAAAC,KAAA,CAAAF,IAAA,GAAAG,IAAA,MAAAA,IAAA,GAAAH,IAAA,EAAAG,IAAA;IAAJF,IAAI,CAAAE,IAAA,IAAAR,SAAA,CAAAQ,IAAA;EAAA;EACxB,OAAO,IAAIjB,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCN,EAAE,CAACsB,IAAI,CAAC,GAAGH,IAAI,EAAE,CAACX,GAAG,EAAEe,SAAS,EAAEC,MAAM,KAAK;MAC3C,IAAIhB,GAAG,EAAE;QACPF,MAAM,CAACE,GAAG,CAAC;MACb,CAAC,MAAM;QACLH,OAAO,CAAC;UAAEkB,SAAS;UAAEC;QAAO,CAAC,CAAC;MAChC;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;AAEA,MAAMC,UAAU,SAASxB,UAAU,CAAC;EAClCyB,WAAWA,CAAChB,IAAI,EAAE;IAChB,KAAK,CAAC,CAAC;IACP,IAAI,CAACA,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACiB,WAAW,GAAGlB,SAAS,CAACC,IAAI,EAAE,GAAG,CAAC;EACzC;EAEA,MAAMkB,UAAUA,CAACC,KAAK,EAAE;IACtB;IACA,MAAM1B,EAAE,GAAG,MAAM,IAAI,CAACwB,WAAW;IACjC,MAAM;MAAEH;IAAO,CAAC,GAAG,MAAMP,SAAS,CAChCd,EAAE,EACF2B,MAAM,CAACC,KAAK,CAACF,KAAK,CAACf,MAAM,CAAC,EAC1B,CAAC,EACDe,KAAK,CAACf,MAAM,EACZe,KAAK,CAACG,MACR,CAAC;IACD,OAAOR,MAAM,CAACA,MAAM;EACtB;EAEA,MAAMjB,KAAKA,CAAA,EAAG;IACZ,MAAMJ,EAAE,GAAG,MAAM,IAAI,CAACwB,WAAW;IACjC,MAAMzB,UAAU,CAACC,EAAE,CAAC;EACtB;AACF;AAEA,OAAO,SAAS8B,cAAcA,CAACvB,IAAI,EAAE;EACnC,OAAO,IAAIe,UAAU,CAACf,IAAI,CAAC;AAC7B"},"metadata":{},"sourceType":"module","externalDependencies":[]}